!function(r){"use strict";var e,c,t,i,s;c={},t=[],i=!1,s=/(.*\/)?([^\/]+?)\.(mp3|ogg|opus|mpeg|wav|m4a|mp4|aiff|wma|mid)$/,createjs.Sound.registerPlugins([createjs.HTMLAudioPlugin]),e=function(r,e,s){var p,x;return p={id:"",success:[],error:[],fileLength:0,complete:null},x="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=16*Math.random()|0,c="x"==r?e:3&e|8;return c.toString(16)}),p.id=x,c[x]=p,new Promise(function(h,g){var m,v,j,y,S;Array.isArray(r)?(S=[],y=f(e)?"":e,r.forEach(function(r,e){a(r.src)?""!==(v=n(r.src))?((j={src:r.src}).id=f(r.id)?v:r.id,j.data=u(r.data)||l(r.data)?r.data:100,m={src:j.src,id:j.id,order:e,groupId:x},t.push(m),S.push(j)):p.error.push({id:v,src:r.src,error:"invalid file"}):((j={id:r.id,src:{}}).data=u(r.data)||l(r.data)?r.data:100,Object.keys(r.src).forEach(function(e){""!==(v=n(r.src[e]))?j.src[e]=r.src[e]:p.error.push({id:v,src:r.src[e],error:"invalid alternate file"})}),m={src:j.src,id:j.id,order:e,groupId:x},t.push(m),S.push(j))})):a(r)?(y="",""!==(v=n(r))?((j={src:r}).id=a(e)?e:v,j.data=u(s)||l(s)?s:100,m={src:j.src,id:j.id,order:0,groupId:x},t.push(m),S=[j]):p.error.push({id:v,src:r,error:"invalid file"})):l(r)&&(y=f(e)?"":e,a(r.src)?""!==(v=n(r.src))?((j={src:r.src}).id=f(r.id)?v:r.id,j.data=u(r.data)||l(r.data)?r.data:100,m={src:j.src,id:j.id,order:0,groupId:x},t.push(m),S=[j]):p.error.push({id:v,src:r.src,error:"invalid file"}):((j={id:r.id,src:{}}).data=u(r.data)||l(r.data)?r.data:100,Object.keys(r.src).forEach(function(e){""!==(v=n(r.src[e]))?j.src[e]=r.src[e]:p.error.push({id:v,src:r.src[e],error:"invalid alternate file"})}),m={src:j.src,id:j.id,order:0,groupId:x},t.push(m),S=[j])),p.fileLength=S.length,createjs.Sound.registerSounds(S,y),p.complete=function(){var r;r={},p.success.length>0?(p.success.sort(function(r,e){return r.order<e.order?-1:r.order>e.order?1:0}),r.success=p.success,p.error.length>0&&(r.error=p.error),h(r)):(r.error=p.error,g(r)),c[p.id]=null,p=null},i||(i=!0,createjs.Sound.on("fileload",o),createjs.Sound.on("fileerror",d))})},r.soundLoader=e;function o(r){var e,i,s,o,d;e=r.id,i=r.src,(o=t.find(function(r){return r.id===e})).src=i,Object.keys(c).forEach(function(r){o.groupId===r&&(s=c[r])}),s.fileLength-=1,l(r.data)&&!f(r.data.audioSprite)&&(d=r.data.audioSprite.map(function(r){return{id:r.id,src:i,order:1/0}}),s.success=s.success.concat(d)),s.success.push(o),0===s.fileLength&&s.complete()}function d(r){var e,i,s,o;e=r.id,i=r.src,s=t.find(function(r){return r.id===e}),Object.keys(c).forEach(function(r){s.groupId===r&&(o=c[r])}),o.error.push({id:e,src:i,error:"load error"}),o.fileLength-=1,0===o.fileLength&&o.complete()}function n(r){var e,c;return e="",null!==(c=r.match(s))&&(e=c[2]),e}function a(r){return"[object String]"===Object.prototype.toString.call(r)}function u(r){return"[object Number]"===Object.prototype.toString.call(r)}function l(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)}function f(r){return void 0===r}}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvdW5kLWxvYWRlci5taW4uanMiXSwibmFtZXMiOlsiZ2xvYmFsIiwic291bmRMb2FkZXIiLCJncm91cHMiLCJjYWNoZXMiLCJpbml0aWFsaXplZCIsIlZBTElEQVRFX1BBVEhfUkVHIiwiY3JlYXRlanMiLCJTb3VuZCIsInJlZ2lzdGVyUGx1Z2lucyIsIkhUTUxBdWRpb1BsdWdpbiIsInNvdXJjZSIsImlkIiwiZGF0YSIsImdyb3VwIiwiZ3JvdXBJZCIsInN1Y2Nlc3MiLCJlcnJvciIsImZpbGVMZW5ndGgiLCJjb21wbGV0ZSIsInJlcGxhY2UiLCJjIiwiciIsIk1hdGgiLCJyYW5kb20iLCJ2IiwidG9TdHJpbmciLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImNhY2hlIiwiYWx0SWQiLCJyZXF1ZXN0IiwicGF0aCIsIm1hbmlmZXN0IiwiQXJyYXkiLCJpc0FycmF5IiwiaXNVbmRlZmluZWQiLCJmb3JFYWNoIiwib2JqIiwiaSIsImlzU3RyaW5nIiwic3JjIiwiZ2V0RmlsZU5hbWUiLCJpc051bWJlciIsImlzT2JqZWN0Iiwib3JkZXIiLCJwdXNoIiwiT2JqZWN0Iiwia2V5cyIsImtleSIsImxlbmd0aCIsInJlZ2lzdGVyU291bmRzIiwicmVzdWx0Iiwic29ydCIsImEiLCJiIiwib24iLCJsb2FkU3VjY2VzcyIsImxvYWRFcnJvciIsImV2ZW50IiwiZmluZCIsImF1ZGlvU3ByaXRlIiwibWFwIiwicCIsIkluZmluaXR5IiwiY29uY2F0IiwibWF0Y2hlZCIsIm1hdGNoIiwidmFsdWUiLCJwcm90b3R5cGUiLCJjYWxsIiwidGhpcyJdLCJtYXBwaW5ncyI6IkNBeURFLFNBQVVBLEdBQ1IsYUFFQSxJQUFJQyxFQUFhQyxFQUFRQyxFQUFRQyxFQUFhQyxFQUM5Q0gsS0FDQUMsS0FDQUMsR0FBYyxFQUNkQyxFQUFvQixrRUFHcEJDLFNBQVNDLE1BQU1DLGlCQUFpQkYsU0FBU0csa0JBRXpDUixFQUFjLFNBQVVTLEVBQVFDLEVBQUlDLEdBQ2hDLElBQUlD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QUt6QixNQUFPLGVBQzNDSCxFQUFNSSxZQUFjLEVBQ0ssSUFBckJKLEVBQU1JLFlBQ05KLEVBQU1LLFdBSWQsU0FBU3dCLEVBQVloQyxHQUNqQixJQUFJMEMsRUFBUWMsRUFNWixPQUxBZCxFQUFTLEdBRU8sUUFEaEJjLEVBQVV4RCxFQUFPeUQsTUFBTTlELE1BRW5CK0MsRUFBVWMsRUFBUSxJQUVmZCxFQUdYLFNBQVNaLEVBQVM0QixHQUNkLE1BQWlELG9CQUExQ3JCLE9BQU9zQixVQUFVNUMsU0FBUzZDLEtBQUtGLEdBRzFDLFNBQVN6QixFQUFTeUIsR0FDZCxNQUFpRCxvQkFBMUNyQixPQUFPc0IsVUFBVTVDLFNBQVM2QyxLQUFLRixHQUcxQyxTQUFTeEIsRUFBU3dCLEdBQ2QsTUFBd0IsaUJBQVZBLEdBQWdDLE9BQVZBLElBQW1CbEMsTUFBTUMsUUFBUWlDLEdBR3pFLFNBQVNoQyxFQUFZZ0MsR0FDakIsWUFBd0IsSUFBVkEsR0EvUXJCLENBaVJDRyIsImZpbGUiOiJzb3VuZC1sb2FkZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogU291bmRMb2FkZXIuanMgMC4wLjNcclxuICogXHJcbiAqIFNvdW5kSlPjg6njgqTjg5bjg6njg6rkvb/nlKjjga7pn7Pmpb3jg5XjgqHjgqTjg6vnsKHmmJPjg63jg7zjg4Djg7xcclxuICogXHJcbiAqIC0tIOS9v+OBhOaWuSAtLVxyXG4gKiAoMSkg6Z+z5qW944OV44Kh44Kk44Or44KS44Gy44Go44Gk44Gg44GR55m76Yyy44GZ44KL5aC05ZCIXHJcbiAqIHNvdW5kTG9hZGVyKCnjg6Hjgr3jg4Pjg4njga7nrKwx5byV5pWw44Gr6Z+z5qW944OV44Kh44Kk44Or44Gu44OR44K544KS5oyH5a6a44GZ44KL77yI5b+F6aCI77yJ44CC5b+F6KaB44Gn44GC44KM44Gw56ysMuW8leaVsOOBq0lE5ZCN44KS44CB56ysM+W8leaVsOOBq2RhdGHjg5fjg63jg5Hjg4bjgqPjgpLmjIflrprjgafjgY3jgovjgYzjgZPjgozjgonjga/nnIHnlaXjgYzlj6/og73jgIJJROWQjeOCkuecgeeVpeOBl+OBn+WgtOWQiOOAgemfs+alveODleOCoeOCpOODq+OBruaLoeW8teWtkOOCkumZpOOBhOOBn+ODleOCoeOCpOODq+WQjeOBq+iHquWLleeahOOBq0lE44GM5Ymy44KK5oyv44KJ44KM44KL44Gu44Gn5rOo5oSP44GM5b+F6KaB77yI6Z+z5qW944KS6bO044KJ44GZ44Go44GNSUTjgYzlv4XopoHjgavjgarjgovvvInjgIJcclxuICpcclxuICogdmFyIGRlZmVycmVkID0gc291bmRMb2FkZXIoJ3NvdW5kLTEubXAzJywgJ21haW4tYmdtJyk7XHJcbiAqXHJcbiAqIOOBvuOBn+OAgeOBk+OCjOOCieOBruaDheWgseOCkuOCquODluOCuOOCp+OCr+ODiOOBq+agvOe0jeOBl+OBn+W9ouOBp+ODoeOCveODg+ODieOBq+a4oeOBmeOBk+OBqOOCguOBp+OBjeOCi+OAglxyXG4gKiB2YXIgZGVmZXJyZWQgPSAkLnNvdW5kTG9hZGVyKHsgc3JjOiAnc291bmQtMS5tcDMnLCBpZDogJ21haW4tYmdtJyB9KTtcclxuICpcclxuICog6KSH5pWw44Gu6Z+z5qW944OV44Kh44Kk44Or44KS5LiA5bqm44Gr5rih44GX44Gf44GE44Go44GN44Gv44CB5LiK6KiY44Gu44Kq44OW44K444Kn44Kv44OI44KS6KaB57Sg44Go44GX44Gf6YWN5YiX44KS5oyH5a6a44GZ44KL44CCXHJcbiAqIHZhciBzb3VuZEZpbGVzID0gW1xyXG4gKiAgICAgeyBzcmM6ICdzb3VuZC0xLm1wMycsIGlkOiAnbWFpbi1iZ20nIH0sXHJcbiAqICAgICB7IHNyYzogJ3NvdW5kLTIubXAzJywgaWQ6ICdzdWItYmdtJyB9LFxyXG4gKiAgICAgeyBzcmM6ICdzb3VuZC0zLm1wMycsIGlkOiAnZ2FtZW92ZXItYmdtJyB9XHJcbiAqIF07XHJcbiAqXHJcbiAqIHZhciBkZWZlcnJlZCA9IHNvdW5kTG9hZGVyKHNvdW5kRmlsZXMpO1xyXG4gKlxyXG4gKiDjgZXjgonjgatTb3VuZEpT44Gr5rqW44GY44Gf44Kq44O844OH44Kj44Kq44K544OX44Op44Kk44OI44Gq44Gp44Gu6auY5bqm44Gq44OH44O844K/44Gu5oyH5a6a44GM44Gn44GN44KL44CCXHJcbiAqIHZhciBzb3VuZEZpbGVzID0gW1xyXG4gKiAgICAge1xyXG4gKiAgICAgICAgIHNyYzogXCJzb3VuZC0xLm1wM1wiLFxyXG4gKiAgICAgICAgIGRhdGE6IHtcclxuICogICAgICAgICAgICAgYXVkaW9TcHJpdGU6IFtcclxuICogICAgICAgICAgICAgICAgIHtpZDogXCJhdWRpby1zcHJpdGUxXCIsIHN0YXJ0VGltZTogMCwgZHVyYXRpb246IDEwMDB9LFxyXG4gKiAgICAgICAgICAgICAgICAge2lkOiBcImF1ZGlvLXNwcml0ZTJcIiwgc3RhcnRUaW1lOiAxNTAwLCBkdXJhdGlvbjogMTAwMH1cclxuICogICAgICAgICAgICAgXVxyXG4gKiAgICAgICAgIH1cclxuICogICAgIH0sXHJcbiAqICAgICB7aWQgXCJzb3VuZC0yXCIsIHNyYzogXCIvYXVkaW8vYmdtL3NvdW5kLTMubXAzXCIsIGRhdGE6IDV9XHJcbiAqIF07XHJcbiAqIFxyXG4gKiDov5TjgorlgKTjga9Qcm9taXNl44Kq44OW44K444Kn44Kv44OI44Go44Gq44KL44CC44GT44KM44KS5aSJ5pWw44Gr5qC857SN44GX44Gm44GK44GN44CBZG9uZSgp44KEdGhlbigp44Oh44K944OD44OJ44Gr44Gk44Gq44GE44Gn44OV44Kh44Kk44Or44Gu44Ot44O844OJ57WC5LqG5b6M44Gu5Yem55CG44KS6KiY6L+w44GZ44KL44CCXHJcbiAqIOOBquOBiuOAgeODoeOCveODg+ODieOBruesrDLlvJXmlbDjgavjg5XjgqHjgqTjg6vjgb7jgafjga7jg5HjgrnjgpLmjIflrprjgafjgY3jgovjgIJcclxuICogXHJcbiAqIHZhciBkZWZlcnJlZCA9IHNvdW5kTG9hZGVyKHNvdW5kRmlsZXMsIGJhc2VQYXRoKTtcclxuICpcclxuICog44Gy44Go44Gk44Gn44KC6Kqt44G/6L6844G/44Gr5oiQ5Yqf44GX44Gf6Z+z5qW944OV44Kh44Kk44Or44GM44GC44KM44Gw44CB5oiQ5Yqf5pmC44Gu44Kz44O844Or44OQ44OD44Kv44GM5ZG844Gz5Ye644GV44KM44KL44CC57WQ5p6c44Gv56ysMeW8leaVsOOBq+OCquODluOCuOOCp+OCr+ODiOOBqOOBl+OBpua4oeOBleOCjOOAgeiqreOBv+i+vOOBv+OBq+aIkOWKn+OBl+OBn+mfs+alveODleOCoeOCpOODq+OBruODquOCueODiOOBjOOBneOBrnN1Y2Nlc3Pjg5fjg63jg5Hjg4bjgqPjgavjgIHlpLHmlZfjgZfjgZ/jg5XjgqHjgqTjg6vjga7jg6rjgrnjg4jjgYxlcnJvcuODl+ODreODkeODhuOCo+OBq+agvOe0jeOBleOCjOOCi+OAglxyXG4gKiDjgZnjgbnjgabjga7pn7Pmpb3jg5XjgqHjgqTjg6vjgYzoqq3jgb/ovrzjgb/jgavlpLHmlZfjgZfjgZ/jgajjgY3jgaDjgZHjgIHlpLHmlZfmmYLjga7jgrPjg7zjg6vjg5Djg4Pjgq/jgYzlkbzjgbPlh7rjgZXjgozjgovjgILjgZPjga7loLTlkIjjgIHnrKwx5byV5pWw44Gr5ZCM5qeY44Gu44Kq44OW44K444Kn44Kv44OI44GM5rih44GV44KM44KL44CCXHJcbiAqIFxyXG4gKiBkZWZlcnJlZC5kb25lKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICogICAgIGlmICh0eXBlb2YgcmVzdWx0LnN1Y2Nlc3MgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAqICAgICAgICAgZG9Tb21ldGhpbmcocmVzdWx0LnN1Y2Nlc3MpO1xyXG4gKiAgICAgfVxyXG4gKiB9KTtcclxuICogXHJcbiAqIOmfs+alveODh+ODvOOCv+OBr+ODj+ODg+OCt+ODpeW9ouW8j+OBp+asoeOBruOCiOOBhuOBquODl+ODreODkeODhuOCo+OCkuaMgeOBpOOAgklE44OX44Ot44OR44OG44Kj44GvY3JlYXRlanMuU291bmQucGxheSgp44Oh44K944OD44OJ44Gq44Gp44KS5Yip55So44GZ44KL44Go44GN44Gr5b+F6KaB44Gr44Gq44KL44CC6Kqt44G/6L6844G/44Gr5aSx5pWX44GX44Gf44OH44O844K/44Gr44Gk44GE44Gm44Gv44CB5aSx5pWX44GX44Gf55CG55Sx44GMZXJyb3Ljg5fjg63jg5Hjg4bjgqPjgavmoLzntI3jgZXjgozjgovjgIJcclxuICogeyBpZDogJ3NvdW5kLTEnLCBzcmM6ICdzb3VuZC0xLm1wMycgfVxyXG4gKiBcclxuICogY3JlYXRlanMuU291bmQucGxheSgnc291bmQtMScpO1xyXG4qL1xyXG5cclxuOyhmdW5jdGlvbiAoZ2xvYmFsKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIHNvdW5kTG9hZGVyLCBncm91cHMsIGNhY2hlcywgaW5pdGlhbGl6ZWQsIFZBTElEQVRFX1BBVEhfUkVHLCBERUZBVUxUX0NIQU5ORUxTO1xyXG4gICAgZ3JvdXBzID0ge307XHJcbiAgICBjYWNoZXMgPSBbXTtcclxuICAgIGluaXRpYWxpemVkID0gZmFsc2U7XHJcbiAgICBWQUxJREFURV9QQVRIX1JFRyA9IC8oLipcXC8pPyhbXlxcL10rPylcXC4obXAzfG9nZ3xvcHVzfG1wZWd8d2F2fG00YXxtcDR8YWlmZnx3bWF8bWlkKSQvO1xyXG4gICAgREVGQVVMVF9DSEFOTkVMUyA9IDEwMDtcclxuXHJcbiAgICBjcmVhdGVqcy5Tb3VuZC5yZWdpc3RlclBsdWdpbnMoW2NyZWF0ZWpzLkhUTUxBdWRpb1BsdWdpbl0pO1xyXG5cclxuICAgIHNvdW5kTG9hZGVyID0gZnVuY3Rpb24gKHNvdXJjZSwgaWQsIGRhdGEpIHtcclxuICAgICAgICB2YXIgZ3JvdXAsIGdyb3VwSWQ7XHJcbiAgICAgICAgZ3JvdXAgPSB7XHJcbiAgICAgICAgICAgIGlkOiAnJyxcclxuICAgICAgICAgICAgc3VjY2VzczogW10sXHJcbiAgICAgICAgICAgIGVycm9yOiBbXSxcclxuICAgICAgICAgICAgZmlsZUxlbmd0aDogMCxcclxuICAgICAgICAgICAgY29tcGxldGU6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGdyb3VwSWQgPSBjcmVhdGVVVUlEKCk7XHJcbiAgICAgICAgZ3JvdXAuaWQ9IGdyb3VwSWQ7XHJcbiAgICAgICAgZ3JvdXBzW2dyb3VwSWRdID0gZ3JvdXA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgdmFyIGNhY2hlLCBhbHRJZCwgcmVxdWVzdCwgcGF0aCwgbWFuaWZlc3QsIGZpbGVMZW5ndGg7XHJcblxyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2UpKSB7XHJcbiAgICAgICAgICAgICAgICBtYW5pZmVzdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9ICFpc1VuZGVmaW5lZChpZCkgPyBpZCA6ICcnO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzb3VyY2UuZm9yRWFjaChmdW5jdGlvbiAob2JqLCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3RyaW5nKG9iai5zcmMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsdElkID0gZ2V0RmlsZU5hbWUob2JqLnNyYyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWx0SWQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ID0ge3NyYzogb2JqLnNyY307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmlkID0gIWlzVW5kZWZpbmVkKG9iai5pZCkgPyBvYmouaWQgOiBhbHRJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QuZGF0YSA9IGlzTnVtYmVyKG9iai5kYXRhKSB8fCBpc09iamVjdChvYmouZGF0YSkgPyBvYmouZGF0YSA6IERFRkFVTFRfQ0hBTk5FTFM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiByZXF1ZXN0LnNyYyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcmVxdWVzdC5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcjogaSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiBncm91cElkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVzLnB1c2goY2FjaGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3QucHVzaChyZXF1ZXN0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cC5lcnJvci5wdXNoKHtpZDogYWx0SWQsIHNyYzogb2JqLnNyYywgZXJyb3I6ICdpbnZhbGlkIGZpbGUnfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ID0ge2lkOiBvYmouaWQsIHNyYzoge319O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmRhdGEgPSBpc051bWJlcihvYmouZGF0YSkgfHwgaXNPYmplY3Qob2JqLmRhdGEpID8gb2JqLmRhdGEgOiBERUZBVUxUX0NIQU5ORUxTO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMob2JqLnNyYykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHRJZCA9IGdldEZpbGVOYW1lKG9iai5zcmNba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWx0SWQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5zcmNba2V5XSA9IG9iai5zcmNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZXJyb3IucHVzaCh7aWQ6IGFsdElkLCBzcmM6IG9iai5zcmNba2V5XSwgZXJyb3I6ICdpbnZhbGlkIGFsdGVybmF0ZSBmaWxlJ30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiByZXF1ZXN0LnNyYyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiByZXF1ZXN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiBncm91cElkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlcy5wdXNoKGNhY2hlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3QucHVzaChyZXF1ZXN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc1N0cmluZyhzb3VyY2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsdElkID0gZ2V0RmlsZU5hbWUoc291cmNlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWx0SWQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QgPSB7c3JjOiBzb3VyY2V9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmlkID0gaXNTdHJpbmcoaWQpID8gaWQgOiBhbHRJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5kYXRhID0gaXNOdW1iZXIoZGF0YSkgfHwgaXNPYmplY3QoZGF0YSkgPyBkYXRhIDogREVGQVVMVF9DSEFOTkVMUztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiByZXF1ZXN0LnNyYyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiByZXF1ZXN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiBncm91cElkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlcy5wdXNoKGNhY2hlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3QgPSBbcmVxdWVzdF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmVycm9yLnB1c2goe2lkOiBhbHRJZCwgc3JjOiBzb3VyY2UsIGVycm9yOiAnaW52YWxpZCBmaWxlJ30pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNPYmplY3Qoc291cmNlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGggPSAhaXNVbmRlZmluZWQoaWQpID8gaWQgOiAnJztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdHJpbmcoc291cmNlLnNyYykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0SWQgPSBnZXRGaWxlTmFtZShzb3VyY2Uuc3JjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsdElkICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdCA9IHtzcmM6IHNvdXJjZS5zcmN9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5pZCA9ICFpc1VuZGVmaW5lZChzb3VyY2UuaWQpID8gc291cmNlLmlkIDogYWx0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmRhdGEgPSBpc051bWJlcihzb3VyY2UuZGF0YSkgfHwgaXNPYmplY3Qoc291cmNlLmRhdGEpID8gc291cmNlLmRhdGEgOiBERUZBVUxUX0NIQU5ORUxTO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogcmVxdWVzdC5zcmMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHJlcXVlc3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogZ3JvdXBJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlcy5wdXNoKGNhY2hlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0ID0gW3JlcXVlc3RdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmVycm9yLnB1c2goe2lkOiBhbHRJZCwgc3JjOiBzb3VyY2Uuc3JjLCBlcnJvcjogJ2ludmFsaWQgZmlsZSd9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QgPSB7aWQ6IHNvdXJjZS5pZCwgc3JjOiB7fX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QuZGF0YSA9IGlzTnVtYmVyKHNvdXJjZS5kYXRhKSB8fCBpc09iamVjdChzb3VyY2UuZGF0YSkgPyBzb3VyY2UuZGF0YSA6IERFRkFVTFRfQ0hBTk5FTFM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2Uuc3JjKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsdElkID0gZ2V0RmlsZU5hbWUoc291cmNlLnNyY1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbHRJZCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LnNyY1trZXldID0gc291cmNlLnNyY1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cC5lcnJvci5wdXNoKHtpZDogYWx0SWQsIHNyYzogc291cmNlLnNyY1trZXldLCBlcnJvcjogJ2ludmFsaWQgYWx0ZXJuYXRlIGZpbGUnfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHJlcXVlc3Quc3JjLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHJlcXVlc3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwSWQ6IGdyb3VwSWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVzLnB1c2goY2FjaGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdCA9IFtyZXF1ZXN0XTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGdyb3VwLmZpbGVMZW5ndGggPSBtYW5pZmVzdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNyZWF0ZWpzLlNvdW5kLnJlZ2lzdGVyU291bmRzKG1hbmlmZXN0LCBwYXRoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGdyb3VwLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCwgaW5kZXg7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKGdyb3VwLnN1Y2Nlc3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnN1Y2Nlc3Muc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYS5vcmRlciA8IGIub3JkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLm9yZGVyID4gYi5vcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zdWNjZXNzID0gZ3JvdXAuc3VjY2VzcztcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAuZXJyb3IubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZXJyb3IgPSBncm91cC5lcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuZXJyb3IgPSBncm91cC5lcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgZ3JvdXBzW2dyb3VwLmlkXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBncm91cCA9IG51bGw7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIWluaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVqcy5Tb3VuZC5vbignZmlsZWxvYWQnLCBsb2FkU3VjY2Vzcyk7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVqcy5Tb3VuZC5vbignZmlsZWVycm9yJywgbG9hZEVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBnbG9iYWwuc291bmRMb2FkZXIgPSBzb3VuZExvYWRlcjtcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gY3JlYXRlVVVJRCgpIHtcclxuICAgICAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDAsIHYgPSBjID09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCk7XHJcbiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gbG9hZFN1Y2Nlc3MoZXZlbnQpIHtcclxuICAgICAgICB2YXIgaWQsIHNyYywgZ3JvdXAsIGNhY2hlLCBkYXRhO1xyXG4gICAgICAgIGlkID0gZXZlbnQuaWQ7XHJcbiAgICAgICAgc3JjID0gZXZlbnQuc3JjO1xyXG4gICAgICAgIGNhY2hlID0gY2FjaGVzLmZpbmQoZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGMuaWQgPT09IGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNhY2hlLnNyYyA9IHNyYztcclxuICAgICAgICBcclxuICAgICAgICBPYmplY3Qua2V5cyhncm91cHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICBpZiAoY2FjaGUuZ3JvdXBJZCA9PT0ga2V5KSB7XHJcbiAgICAgICAgICAgICAgICBncm91cCA9IGdyb3Vwc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZ3JvdXAuZmlsZUxlbmd0aCAtPSAxO1xyXG5cclxuICAgICAgICBpZiAoaXNPYmplY3QoZXZlbnQuZGF0YSkgJiYgIWlzVW5kZWZpbmVkKGV2ZW50LmRhdGEuYXVkaW9TcHJpdGUpKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBldmVudC5kYXRhLmF1ZGlvU3ByaXRlLm1hcChmdW5jdGlvbiAocCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtpZDogcC5pZCwgc3JjOiBzcmMsIG9yZGVyOiBJbmZpbml0eX07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBncm91cC5zdWNjZXNzID0gZ3JvdXAuc3VjY2Vzcy5jb25jYXQoZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBncm91cC5zdWNjZXNzLnB1c2goY2FjaGUpO1xyXG4gICAgICAgICAgICBpZiAoZ3JvdXAuZmlsZUxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBncm91cC5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsb2FkRXJyb3IoZXZlbnQpIHtcclxuICAgICAgICB2YXIgaWQsIHNyYywgY2FjaGUsIGdyb3VwO1xyXG4gICAgICAgIGlkID0gZXZlbnQuaWQ7XHJcbiAgICAgICAgc3JjID0gZXZlbnQuc3JjO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNhY2hlID0gY2FjaGVzLmZpbmQoZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGMuaWQgPT09IGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIE9iamVjdC5rZXlzKGdyb3VwcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZS5ncm91cElkID09PSBrZXkpIHtcclxuICAgICAgICAgICAgICAgIGdyb3VwID0gZ3JvdXBzW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBncm91cC5lcnJvci5wdXNoKHtpZDogaWQsIHNyYzogc3JjLCBlcnJvcjogJ2xvYWQgZXJyb3InfSk7XHJcbiAgICAgICAgZ3JvdXAuZmlsZUxlbmd0aCAtPSAxO1xyXG4gICAgICAgIGlmIChncm91cC5maWxlTGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGdyb3VwLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEZpbGVOYW1lKHNvdXJjZSkge1xyXG4gICAgICAgIHZhciByZXN1bHQsIG1hdGNoZWQ7XHJcbiAgICAgICAgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgbWF0Y2hlZCA9IHNvdXJjZS5tYXRjaChWQUxJREFURV9QQVRIX1JFRyk7XHJcbiAgICAgICAgaWYgKG1hdGNoZWQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gIG1hdGNoZWRbMl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNTdHJpbmcodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgU3RyaW5nXSc7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IE51bWJlcl0nO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCc7XHJcbiAgICB9XHJcbn0odGhpcykpOyJdfQ==
